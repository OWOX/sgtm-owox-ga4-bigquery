___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "owox_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "OWOX BI GA4 Web Streaming To Google BigQuery",
  "brand": {
    "id": "owox",
    "displayName": "OWOX",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Send (duplicate) GA4-like events to OWOX BI endpoint to be delivered to Google BigQuery. The \"Data Stream URL\" (endpoint) should be configured in advance",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "dataStreamUrl",
    "displayName": "Data Stream Url",
    "simpleValueType": true,
    "valueHint": "https://streaming.bi.owox.com/ga4/",
    "help": "The \"Data Stream URL\" (endpoint) should be configured in advance"
  }
]


___SANDBOXED_JS_FOR_SERVER___

const logToConsole = require('logToConsole');
const getRequestHeader = require('getRequestHeader');
const getRequestBody = require('getRequestBody');
const getRequestQueryString = require('getRequestQueryString');
const Object = require('Object');
const sendHttpRequest = require('sendHttpRequest');

const setResponseStatus = require('setResponseStatus');
const setCookie = require('setCookie');
const returnResponse = require('returnResponse');

const userAgent = getRequestHeader('User-Agent');

const requestBody = getRequestBody();
const forwardedForIps = getRequestHeader('X-Forwarded-For');

const queryString = getRequestQueryString();
let postUrl = data.dataStreamUrl;

if (queryString !== '') {
    postUrl = postUrl + '/g/collect/?' + queryString;
}

sendHttpRequest(postUrl, {
    headers: {
        "X-Forwarded-For": forwardedForIps,
        'Content-Type': 'text/plain;charset=UTF-8',
        'User-Agent': userAgent
    },
    method: 'POST',
    timeout: 500,
}, requestBody).then((result) => {

    const cookieStr = result.headers["set-cookie"];
    let cookieParams = {};
    let parts = cookieStr[0].split('; ');

    for (let i = 0; i < parts.length; i++) {
        if (parts[i].indexOf('=') !== -1) {
            let pair = parts[i].split('=');
            cookieParams[pair[0]] = pair[1];
        } else {
            cookieParams[parts[i]] = true;
        }
    }

    const cookieNameValue = parts[0].split('=');
    const cookieName = cookieNameValue[0];
    const cookieValue = cookieNameValue[1];

    Object.delete(cookieParams, cookieName);
    setResponseStatus(200);

    if (cookieName && cookieValue) {
        setCookie(cookieName, cookieValue, cookieParams);
    }

    returnResponse();
    data.gtmOnSuccess();

}).catch(() => {
    data.gtmOnFailure();
});


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://streaming.bi.owox.com/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_response",
        "versionId": "1"
      },
      "param": [
        {
          "key": "writeResponseAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "writeHeaderAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "writeStatusAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "writeHeadersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "writeHeaderWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "X-Forwarded-For"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "User-Agent"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ouid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "return_response",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 01/11/2024, 17:57:49


